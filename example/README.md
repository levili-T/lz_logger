# lz_logger_example

å®Œæ•´çš„ lz_logger ç¤ºä¾‹é¡¹ç›®ï¼ŒåŒ…å«æ€§èƒ½æµ‹è¯•å’Œå¤šçº¿ç¨‹æµ‹è¯•ã€‚

## é¡¹ç›®ç»“æ„

```
example/
â”œâ”€â”€ lib/main.dart                    # Flutter UI + Dart FFI å¤šçº¿ç¨‹æµ‹è¯•
â”œâ”€â”€ android/
â”‚   â””â”€â”€ app/src/
â”‚       â”œâ”€â”€ main/                    # Android åŸç”Ÿåˆå§‹åŒ–
â”‚       â””â”€â”€ androidTest/             # Android æ€§èƒ½æµ‹è¯•
â””â”€â”€ ios/
    â”œâ”€â”€ Runner/                      # iOS åŸç”Ÿåˆå§‹åŒ–
    â””â”€â”€ RunnerTests/                 # iOS æ€§èƒ½æµ‹è¯•
```

## åŠŸèƒ½è¯´æ˜

### 1. Flutter UI Demo (lib/main.dart) - å¤šçº¿ç¨‹ç¨³å®šæ€§æµ‹è¯•

**æµ‹è¯•ç›®çš„**ï¼šéªŒè¯å¤šçº¿ç¨‹å¹¶å‘å†™å…¥çš„**æ­£ç¡®æ€§å’Œç¨³å®šæ€§**ï¼ˆéæ€§èƒ½æµ‹è¯•ï¼‰

**æµ‹è¯•åœºæ™¯**ï¼š
- ğŸ¯ **ç›®æ ‡**ï¼šæµ‹è¯• CAS æ— é”è®¾è®¡åœ¨å¹¶å‘åœºæ™¯ä¸‹çš„æ­£ç¡®æ€§
- ğŸ“ **æ–¹å¼**ï¼š4 ä¸ª Dart Isolateï¼ˆçœŸæ­£çš„ç³»ç»Ÿçº¿ç¨‹ï¼‰åŒæ—¶å†™å…¥
- ğŸ”¢ **è´Ÿè½½**ï¼šæ¯ä¸ªçº¿ç¨‹ 20,000 æ¡æ—¥å¿— = æ€»è®¡ 80,000 æ¡
- â±ï¸ **ç«äº‰**ï¼šéšæœº 0-20ms å»¶è¿Ÿï¼Œåˆ¶é€ å¹¶å‘ç«äº‰å’Œé”ç«äº‰åœºæ™¯
- âœ… **éªŒè¯**ï¼šè¿è¡Œå®Œæˆæ— å´©æºƒã€æ— æ­»é”ã€æ— æ•°æ®æŸå

**è¿è¡Œæ–¹å¼**ï¼š
```bash
cd example
flutter run
# 1. ç‚¹å‡» "Send Log" æŒ‰é’®å¼€å§‹æµ‹è¯•
# 2. ç­‰å¾…çº¦ 5-10 åˆ†é’Ÿï¼ˆé•¿æ—¶é—´å¹¶å‘å‹åŠ›æµ‹è¯•ï¼‰
# 3. å®Œæˆåæ˜¾ç¤º "Completed!"
# 4. æ£€æŸ¥æ—¥å¿—æ–‡ä»¶å®Œæ•´æ€§ï¼ˆæ— å´©æºƒ = âœ…ï¼‰
```

**ä¸ºä»€ä¹ˆä¸æ˜¯æ€§èƒ½æµ‹è¯•ï¼Ÿ**
- æ€§èƒ½æµ‹è¯•åº”è¯¥**å°½å¿«å†™å®Œ**ï¼Œæµ‹è¯•ååé‡
- æ­¤æµ‹è¯•æ•…æ„**åŠ å»¶è¿Ÿ**ï¼Œåˆ¶é€ å¹¶å‘ç«äº‰åœºæ™¯
- é‡ç‚¹éªŒè¯ï¼šå¤šçº¿ç¨‹å®‰å…¨æ€§ > å†™å…¥é€Ÿåº¦

---

### 2. iOS æ€§èƒ½æµ‹è¯• (ios/RunnerTests/)

**æµ‹è¯•ç”¨ä¾‹**ï¼š
- âœ… æ— åŠ å¯†ï¼šçŸ­æ¶ˆæ¯ï¼ˆ50å­—èŠ‚ï¼‰ã€ä¸­ç­‰æ¶ˆæ¯ï¼ˆ150å­—èŠ‚ï¼‰ã€é•¿æ¶ˆæ¯ï¼ˆ300å­—èŠ‚ï¼‰
- âœ… æœ‰åŠ å¯†ï¼šçŸ­æ¶ˆæ¯ã€ä¸­ç­‰æ¶ˆæ¯ã€é•¿æ¶ˆæ¯
- âœ… æé™æµ‹è¯•ï¼šè¿ç»­å†™å…¥ 10,000 æ¡ï¼ˆæ— åŠ å¯†/æœ‰åŠ å¯†ï¼‰

**è¿è¡Œæ–¹å¼**ï¼š
```bash
cd example/ios
xcodebuild test \
  -workspace Runner.xcworkspace \
  -scheme Runner \
  -destination 'platform=iOS Simulator,name=iPhone 15'
  
# æˆ–åœ¨ Xcode ä¸­ï¼šâŒ˜+U
```

**æŸ¥çœ‹ç»“æœ**ï¼š
- Xcode â†’ Test Navigator â†’ æŸ¥çœ‹å„æµ‹è¯•ç”¨ä¾‹çš„å¹³å‡è€—æ—¶
- XCTest è‡ªåŠ¨è¿è¡Œ 10 æ¬¡å–å¹³å‡å€¼

### 3. Android æ€§èƒ½æµ‹è¯• (android/app/src/androidTest/)

**æµ‹è¯•ç”¨ä¾‹**ï¼š
- âœ… æ— åŠ å¯†ï¼šçŸ­æ¶ˆæ¯ï¼ˆ50å­—èŠ‚ï¼‰ã€ä¸­ç­‰æ¶ˆæ¯ï¼ˆ150å­—èŠ‚ï¼‰ã€é•¿æ¶ˆæ¯ï¼ˆ300å­—èŠ‚ï¼‰
- âœ… æœ‰åŠ å¯†ï¼šçŸ­æ¶ˆæ¯ã€ä¸­ç­‰æ¶ˆæ¯ã€é•¿æ¶ˆæ¯
- âœ… æé™æµ‹è¯•ï¼šè¿ç»­å†™å…¥ 10,000 æ¡ï¼ˆæ— åŠ å¯†/æœ‰åŠ å¯†ï¼‰

**è¿è¡Œæ–¹å¼**ï¼š
```bash
cd example/android
./gradlew connectedAndroidTest

# æˆ–ä½¿ç”¨ Android Studioï¼š
# å³é”® LzLoggerPerformanceTest.java â†’ Run
```

**æŸ¥çœ‹ç»“æœ**ï¼š
```bash
# æµ‹è¯•æŠ¥å‘Šï¼š
open app/build/reports/androidTests/connected/index.html

# Logcat è¾“å‡ºï¼š
adb logcat -s LzLoggerPerf
```

## æ€§èƒ½æµ‹è¯•ç»“æœè¯´æ˜

### æµ‹è¯•æ–¹æ³•

1. **é¢„çƒ­é˜¶æ®µ**ï¼šå†™å…¥ 1000 æ¡æ—¥å¿—ï¼ˆç¡®ä¿ CPU ç¼“å­˜ç¨³å®šï¼‰
2. **æµ‹é‡é˜¶æ®µ**ï¼š
   - iOS: XCTest `measureBlock` è‡ªåŠ¨è¿è¡Œ 10 æ¬¡
   - Android: æ‰‹åŠ¨è®¡æ—¶ï¼Œè®¡ç®—å¹³å‡è€—æ—¶å’Œååé‡
3. **åŒ…å« flush**ï¼šç¡®ä¿æ‰€æœ‰æ•°æ®å†™å…¥ç£ç›˜

### é¢„æœŸæ€§èƒ½ï¼ˆå‚è€ƒï¼‰

**å•çº¿ç¨‹ï¼ˆApple Silicon / é«˜ç«¯ Androidï¼‰**ï¼š
- æ— åŠ å¯†ï¼š~0.5-1.0 Î¼s/æ¡ï¼ˆ100-200ä¸‡æ¡/ç§’ï¼‰
- æœ‰åŠ å¯†ï¼š~1.5-3.0 Î¼s/æ¡ï¼ˆ30-70ä¸‡æ¡/ç§’ï¼‰

**å¤šçº¿ç¨‹ï¼ˆ4çº¿ç¨‹ï¼‰**ï¼š
- æ€»ååé‡ï¼š~50-100ä¸‡æ¡/ç§’
- æ€§èƒ½ä¿æŒç‡ï¼š30-40%ï¼ˆæ­£å¸¸ï¼Œå› ä¸ºæ–‡ä»¶åˆ‡æ¢å¼€é”€ï¼‰

### æ€§èƒ½ä¼˜åŒ–è¦ç‚¹

1. âœ… **é¢„çƒ­å……åˆ†**ï¼š1000 æ¡é¢„çƒ­ç¡®ä¿ç¼“å­˜ç¨³å®š
2. âœ… **åŒ…å« flush**ï¼šçœŸå®åœºæ™¯éœ€è¦æŒä¹…åŒ–
3. âœ… **å®Œæ•´æ—¥å¿—**ï¼šåŒ…å«æ—¶é—´æˆ³ã€æ ‡ç­¾ã€æ–‡ä»¶åç­‰
4. âœ… **ç‹¬ç«‹æµ‹è¯•**ï¼šæ¯æ¬¡æµ‹è¯•å…³é—­å¹¶é‡æ–°æ‰“å¼€ logger

## å¼€å‘è¯´æ˜

### åŸç”Ÿä¾§åˆå§‹åŒ–

**Android (MainActivity.kt)**ï¼š
```kotlin
LzLogger.setLogLevel(LzLogger.DEBUG)
LzLogger.prepareLog(applicationContext, "laozhaozhao", "encryptKey")
```

**iOS (AppDelegate.swift)**ï¼š
```swift
LZLogger.sharedInstance().prepareLog("testlog", encryptKey: "encryptKey")
```

### Dart FFI ä½¿ç”¨

```dart
import 'package:lz_logger/lz_logger.dart';

// ç›´æ¥ä½¿ç”¨ï¼ˆåŸç”Ÿä¾§å·²åˆå§‹åŒ–ï¼‰
lzLogInfo('Tag', 'Message');
lzLogDebug('Tag', 'Message');
lzLogWarn('Tag', 'Message');
lzLogError('Tag', 'Message');
lzLogFatal('Tag', 'Message');
```

## æ•…éšœæ’æŸ¥

### iOS æµ‹è¯•å¤±è´¥
```bash
# æ£€æŸ¥æ—¥å¿—ç›®å½•æƒé™
po NSTemporaryDirectory()

# æ£€æŸ¥æ˜¯å¦æˆåŠŸåˆ›å»º logger
æ–­ç‚¹è®¾ç½®åœ¨ lz_logger_open
```

### Android æµ‹è¯•å¤±è´¥
```bash
# æ£€æŸ¥æ—¥å¿—è·¯å¾„
adb shell ls -la /sdcard/Android/data/<package>/files/logs/

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
adb logcat -s LzLogger:V LzLoggerPerf:V
```

## æ›´å¤šä¿¡æ¯

- é¡¹ç›®ä¸»é¡µ: [lz_logger](../)
- æ€§èƒ½æŠ¥å‘Š: [PERFORMANCE_REPORT.md](../PERFORMANCE_REPORT.md)
- ä¼˜åŒ–æ€»ç»“: [OPTIMIZATION_SUMMARY.md](../OPTIMIZATION_SUMMARY.md)
